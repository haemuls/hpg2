{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":["file:///Users/haemul/Desktop/docu/hpground/hpg/src/app/layout.tsx"],"sourcesContent":["'use client';\nimport React, { useState, useEffect } from 'react';\nimport Script from 'next/script';\nimport { Dropdown } from 'react-bootstrap';\nimport Link from 'next/link';\nimport { getValidAccessToken, clearTokens, getUserNickname, fetchActiveUsers } from './api'; // API 함수 import\n\nconst RootLayout = ({ children }: { children: React.ReactNode }) => {\n  const [nickname, setNickname] = useState<string | null>(null);\n  const [activeUserCount, setActiveUserCount] = useState<number | null>(null);\n\n  useEffect(() => {\n    if (typeof window !== 'undefined') {\n      const initializeUser = async () => {\n        try {\n          // 유효한 액세스 토큰을 얻기\n          const accessToken = await getValidAccessToken();\n          if (!accessToken) {\n            clearTokens();\n            setNickname(null);\n            setActiveUserCount(null);\n            return;\n          }\n\n          // 액세스 토큰이 유효한 경우 닉네임 가져오기\n          const storedNickname = await getUserNickname();\n          setNickname(storedNickname);\n\n          // 유효한 토큰이 있을 경우 액티브 사용자 수 가져오기\n          fetchActiveUsers(accessToken);\n        } catch (error) {\n          console.error('사용자 정보 초기화 실패:', error);\n          clearTokens();\n          setNickname(null);\n          setActiveUserCount(null);\n        }\n      };\n\n      initializeUser();\n    }\n  }, []);\n\n  const handleLogout = () => {\n    clearTokens();\n    setNickname(null);\n    setActiveUserCount(null);\n  };\n\n  const fetchActiveUsers = async (token: string) => {\n    try {\n      const response = await fetch(\n        'https://ec2-3-34-134-27.ap-northeast-2.compute.amazonaws.com/api/pods/active?namespace=wargame',\n        {\n          method: 'GET',\n          headers: {\n            Authorization: `Bearer ${token}`,\n            Accept: 'application/json',\n          },\n        }\n      );\n\n      if (response.ok) {\n        const data = await response.json();\n        setActiveUserCount(Object.keys(data).length); // 사용자-문제 매핑 개수를 카운트\n      } else {\n        console.error('Failed to fetch active users:', response.status);\n        setActiveUserCount(null);\n      }\n    } catch (error) {\n      console.error('Error fetching active users:', error);\n      setActiveUserCount(null);\n    }\n  };\n\n  return (\n    <html lang=\"ko\">\n      <head>\n        <title>Hack Playground - CTF 사이트</title>\n        <meta charSet=\"utf-8\" />\n        <meta httpEquiv=\"X-UA-Compatible\" content=\"IE=edge\" />\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1, shrink-to-fit=no\" />\n        <meta name=\"keywords\" content=\"CTF, 해킹, 보안, 문제 풀이\" />\n        <meta name=\"description\" content=\"CTF 사이트 테스트용 페이지\" />\n        <link rel=\"icon\" href=\"/images/test_sione.jpeg\" type=\"image/gif\" />\n        <link rel=\"stylesheet\" href=\"/styles/bootstrap.css\" />\n        <link\n          href=\"https://fonts.googleapis.com/css?family=Poppins:400,600,700&display=swap\"\n          rel=\"stylesheet\"\n        />\n        <link rel=\"stylesheet\" href=\"/styles/font-awesome.min.css\" />\n        <link rel=\"stylesheet\" href=\"/styles/style.css\" />\n        <link rel=\"stylesheet\" href=\"/styles/responsive.css\" />\n        <link rel=\"stylesheet\" href=\"/styles/navbar-hover.css\" />\n      </head>\n      <body className=\"sub_page\">\n        <div className=\"hero_area\">\n          <header className=\"header_section long_section px-0\">\n            <nav className=\"navbar navbar-expand-lg custom_nav-container\">\n              <Link className=\"navbar-brand\" href=\"/\">\n                <span>Hack Playground</span>\n              </Link>\n              <button\n                className=\"navbar-toggler\"\n                type=\"button\"\n                data-toggle=\"collapse\"\n                data-target=\"#navbarSupportedContent\"\n              >\n                <span> </span>\n              </button>\n              <div className=\"collapse navbar-collapse\" id=\"navbarSupportedContent\">\n                <ul className=\"navbar-nav d-flex mx-auto flex-column flex-lg-row align-items-center\">\n                  <li className=\"nav-item\">\n                    <Link className=\"nav-link\" href=\"/\">\n                      HOME\n                    </Link>\n                  </li>\n                  <li className=\"nav-item\">\n                    <Link className=\"nav-link\" href=\"/notice\">\n                      Notice\n                    </Link>\n                  </li>\n                  <li className=\"nav-item\">\n                    <Link className=\"nav-link\" href=\"/game\">\n                      GAME\n                    </Link>\n                  </li>\n                  <li className=\"nav-item\">\n                    <Link className=\"nav-link\" href=\"/ranking\">\n                      Ranking\n                    </Link>\n                  </li>\n                  <li className=\"nav-item\">\n                    <Link className=\"nav-link\" href=\"/board\">\n                      자유 게시판\n                    </Link>\n                  </li>\n                </ul>\n                <div className=\"quote_btn-container\">\n                  {nickname ? (\n                    <Dropdown>\n                      <Dropdown.Toggle variant=\"success\" id=\"dropdown-basic\">\n                        {nickname}\n                        {activeUserCount !== null && (\n                          <span style={{ marginLeft: '10px', fontSize: '0.9em', color: '#fff' }}>\n                            ({activeUserCount}명 접속 중)\n                          </span>\n                        )}\n                      </Dropdown.Toggle>\n                      <Dropdown.Menu>\n                        <Dropdown.Item onClick={handleLogout}>로그아웃</Dropdown.Item>\n                      </Dropdown.Menu>\n                    </Dropdown>\n                  ) : (\n                    <Link href=\"/login\">\n                      <span>Login</span>\n                      <i className=\"fa fa-user\" aria-hidden=\"true\"></i>\n                    </Link>\n                  )}\n                </div>\n              </div>\n            </nav>\n          </header>\n        </div>\n\n        <main>{children}</main>\n\n        <footer className=\"footer_section\">\n          <p>&copy; 2025 hpground.xyz</p>\n        </footer>\n\n        {/* 비동기 로드 스크립트 */}\n        <Script src=\"/js/jquery-3.4.1.min.js\" strategy=\"beforeInteractive\" />\n        <Script src=\"/js/bootstrap.js\" strategy=\"beforeInteractive\" />\n        <Script src=\"/js/navbar-hover.js\" strategy=\"beforeInteractive\" />\n        <Script src=\"/js/custom.js\" strategy=\"lazyOnload\" />\n      </body>\n    </html>\n  );\n};\n\nexport default RootLayout;\n"],"names":[],"mappings":"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","debugId":null}}]
}